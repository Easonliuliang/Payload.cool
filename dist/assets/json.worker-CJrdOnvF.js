(function(){"use strict";function q(e,u=!1){const s=e.length;let n=0,l="",k=0,c=16,w=0,o=0,b=0,O=0,r=0;function U(t,m){let T=0,g=0;for(;T<t;){let i=e.charCodeAt(n);if(i>=48&&i<=57)g=g*16+i-48;else if(i>=65&&i<=70)g=g*16+i-65+10;else if(i>=97&&i<=102)g=g*16+i-97+10;else break;n++,T++}return T<t&&(g=-1),g}function _(t){n=t,l="",k=0,c=16,r=0}function V(){let t=n;if(e.charCodeAt(n)===48)n++;else for(n++;n<e.length&&A(e.charCodeAt(n));)n++;if(n<e.length&&e.charCodeAt(n)===46)if(n++,n<e.length&&A(e.charCodeAt(n)))for(n++;n<e.length&&A(e.charCodeAt(n));)n++;else return r=3,e.substring(t,n);let m=n;if(n<e.length&&(e.charCodeAt(n)===69||e.charCodeAt(n)===101))if(n++,(n<e.length&&e.charCodeAt(n)===43||e.charCodeAt(n)===45)&&n++,n<e.length&&A(e.charCodeAt(n))){for(n++;n<e.length&&A(e.charCodeAt(n));)n++;m=n}else r=3;return e.substring(t,m)}function y(){let t="",m=n;for(;;){if(n>=s){t+=e.substring(m,n),r=2;break}const T=e.charCodeAt(n);if(T===34){t+=e.substring(m,n),n++;break}if(T===92){if(t+=e.substring(m,n),n++,n>=s){r=2;break}switch(e.charCodeAt(n++)){case 34:t+='"';break;case 92:t+="\\";break;case 47:t+="/";break;case 98:t+="\b";break;case 102:t+="\f";break;case 110:t+=`
`;break;case 114:t+="\r";break;case 116:t+="	";break;case 117:const i=U(4);i>=0?t+=String.fromCharCode(i):r=4;break;default:r=5}m=n;continue}if(T>=0&&T<=31)if(v(T)){t+=e.substring(m,n),r=2;break}else r=6;n++}return t}function a(){if(l="",r=0,k=n,o=w,O=b,n>=s)return k=s,c=17;let t=e.charCodeAt(n);if(I(t)){do n++,l+=String.fromCharCode(t),t=e.charCodeAt(n);while(I(t));return c=15}if(v(t))return n++,l+=String.fromCharCode(t),t===13&&e.charCodeAt(n)===10&&(n++,l+=`
`),w++,b=n,c=14;switch(t){case 123:return n++,c=1;case 125:return n++,c=2;case 91:return n++,c=3;case 93:return n++,c=4;case 58:return n++,c=6;case 44:return n++,c=5;case 34:return n++,l=y(),c=10;case 47:const m=n-1;if(e.charCodeAt(n+1)===47){for(n+=2;n<s&&!v(e.charCodeAt(n));)n++;return l=e.substring(m,n),c=12}if(e.charCodeAt(n+1)===42){n+=2;const T=s-1;let g=!1;for(;n<T;){const i=e.charCodeAt(n);if(i===42&&e.charCodeAt(n+1)===47){n+=2,g=!0;break}n++,v(i)&&(i===13&&e.charCodeAt(n)===10&&n++,w++,b=n)}return g||(n++,r=1),l=e.substring(m,n),c=13}return l+=String.fromCharCode(t),n++,c=16;case 45:if(l+=String.fromCharCode(t),n++,n===s||!A(e.charCodeAt(n)))return c=16;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return l+=V(),c=11;default:for(;n<s&&E(t);)n++,t=e.charCodeAt(n);if(k!==n){switch(l=e.substring(k,n),l){case"true":return c=8;case"false":return c=9;case"null":return c=7}return c=16}return l+=String.fromCharCode(t),n++,c=16}}function E(t){if(I(t)||v(t))return!1;switch(t){case 125:case 93:case 123:case 91:case 34:case 58:case 44:case 47:return!1}return!0}function F(){let t;do t=a();while(t>=12&&t<=15);return t}return{setPosition:_,getPosition:()=>n,scan:u?F:a,getToken:()=>c,getTokenValue:()=>l,getTokenOffset:()=>k,getTokenLength:()=>n-k,getTokenStartLine:()=>o,getTokenStartCharacter:()=>k-O,getTokenError:()=>r}}function I(e){return e===32||e===9}function v(e){return e===10||e===13}function A(e){return e>=48&&e<=57}var R;(function(e){e[e.lineFeed=10]="lineFeed",e[e.carriageReturn=13]="carriageReturn",e[e.space=32]="space",e[e._0=48]="_0",e[e._1=49]="_1",e[e._2=50]="_2",e[e._3=51]="_3",e[e._4=52]="_4",e[e._5=53]="_5",e[e._6=54]="_6",e[e._7=55]="_7",e[e._8=56]="_8",e[e._9=57]="_9",e[e.a=97]="a",e[e.b=98]="b",e[e.c=99]="c",e[e.d=100]="d",e[e.e=101]="e",e[e.f=102]="f",e[e.g=103]="g",e[e.h=104]="h",e[e.i=105]="i",e[e.j=106]="j",e[e.k=107]="k",e[e.l=108]="l",e[e.m=109]="m",e[e.n=110]="n",e[e.o=111]="o",e[e.p=112]="p",e[e.q=113]="q",e[e.r=114]="r",e[e.s=115]="s",e[e.t=116]="t",e[e.u=117]="u",e[e.v=118]="v",e[e.w=119]="w",e[e.x=120]="x",e[e.y=121]="y",e[e.z=122]="z",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.asterisk=42]="asterisk",e[e.backslash=92]="backslash",e[e.closeBrace=125]="closeBrace",e[e.closeBracket=93]="closeBracket",e[e.colon=58]="colon",e[e.comma=44]="comma",e[e.dot=46]="dot",e[e.doubleQuote=34]="doubleQuote",e[e.minus=45]="minus",e[e.openBrace=123]="openBrace",e[e.openBracket=91]="openBracket",e[e.plus=43]="plus",e[e.slash=47]="slash",e[e.formFeed=12]="formFeed",e[e.tab=9]="tab"})(R||(R={})),new Array(20).fill(0).map((e,u)=>" ".repeat(u));const B=200;new Array(B).fill(0).map((e,u)=>`
`+" ".repeat(u)),new Array(B).fill(0).map((e,u)=>"\r"+" ".repeat(u)),new Array(B).fill(0).map((e,u)=>`\r
`+" ".repeat(u)),new Array(B).fill(0).map((e,u)=>`
`+"	".repeat(u)),new Array(B).fill(0).map((e,u)=>"\r"+"	".repeat(u)),new Array(B).fill(0).map((e,u)=>`\r
`+"	".repeat(u));var L;(function(e){e.DEFAULT={allowTrailingComma:!1}})(L||(L={}));function G(e,u=[],s=L.DEFAULT){let n=null,l=[];const k=[];function c(o){Array.isArray(l)?l.push(o):n!==null&&(l[n]=o)}return H(e,{onObjectBegin:()=>{const o={};c(o),k.push(l),l=o,n=null},onObjectProperty:o=>{n=o},onObjectEnd:()=>{l=k.pop()},onArrayBegin:()=>{const o=[];c(o),k.push(l),l=o,n=null},onArrayEnd:()=>{l=k.pop()},onLiteralValue:c,onError:(o,b,O)=>{u.push({error:o,offset:b,length:O})}},s),l[0]}function H(e,u,s=L.DEFAULT){const n=q(e,!1),l=[];let k=0;function c(f){return f?()=>k===0&&f(n.getTokenOffset(),n.getTokenLength(),n.getTokenStartLine(),n.getTokenStartCharacter()):()=>!0}function w(f){return f?p=>k===0&&f(p,n.getTokenOffset(),n.getTokenLength(),n.getTokenStartLine(),n.getTokenStartCharacter()):()=>!0}function o(f){return f?p=>k===0&&f(p,n.getTokenOffset(),n.getTokenLength(),n.getTokenStartLine(),n.getTokenStartCharacter(),()=>l.slice()):()=>!0}function b(f){return f?()=>{k>0?k++:f(n.getTokenOffset(),n.getTokenLength(),n.getTokenStartLine(),n.getTokenStartCharacter(),()=>l.slice())===!1&&(k=1)}:()=>!0}function O(f){return f?()=>{k>0&&k--,k===0&&f(n.getTokenOffset(),n.getTokenLength(),n.getTokenStartLine(),n.getTokenStartCharacter())}:()=>!0}const r=b(u.onObjectBegin),U=o(u.onObjectProperty),_=O(u.onObjectEnd),V=b(u.onArrayBegin),y=O(u.onArrayEnd),a=o(u.onLiteralValue),E=w(u.onSeparator),F=c(u.onComment),t=w(u.onError),m=s&&s.disallowComments,T=s&&s.allowTrailingComma;function g(){for(;;){const f=n.scan();switch(n.getTokenError()){case 4:i(14);break;case 5:i(15);break;case 3:i(13);break;case 1:m||i(11);break;case 2:i(12);break;case 6:i(16);break}switch(f){case 12:case 13:m?i(10):F();break;case 16:i(1);break;case 15:case 14:break;default:return f}}}function i(f,p=[],W=[]){if(t(f),p.length+W.length>0){let N=n.getToken();for(;N!==17;){if(p.indexOf(N)!==-1){g();break}else if(W.indexOf(N)!==-1)break;N=g()}}}function S(f){const p=n.getTokenValue();return f?a(p):(U(p),l.push(p)),g(),!0}function $(){switch(n.getToken()){case 11:const f=n.getTokenValue();let p=Number(f);isNaN(p)&&(i(2),p=0),a(p);break;case 7:a(null);break;case 8:a(!0);break;case 9:a(!1);break;default:return!1}return g(),!0}function z(){return n.getToken()!==10?(i(3,[],[2,5]),!1):(S(!1),n.getToken()===6?(E(":"),g(),j()||i(4,[],[2,5])):i(5,[],[2,5]),l.pop(),!0)}function X(){r(),g();let f=!1;for(;n.getToken()!==2&&n.getToken()!==17;){if(n.getToken()===5){if(f||i(4,[],[]),E(","),g(),n.getToken()===2&&T)break}else f&&i(6,[],[]);z()||i(4,[],[2,5]),f=!0}return _(),n.getToken()!==2?i(7,[2],[]):g(),!0}function Z(){V(),g();let f=!0,p=!1;for(;n.getToken()!==4&&n.getToken()!==17;){if(n.getToken()===5){if(p||i(4,[],[]),E(","),g(),n.getToken()===4&&T)break}else p&&i(6,[],[]);f?(l.push(0),f=!1):l[l.length-1]++,j()||i(4,[],[4,5]),p=!0}return y(),f||l.pop(),n.getToken()!==4?i(8,[4],[]):g(),!0}function j(){switch(n.getToken()){case 3:return Z();case 1:return X();case 10:return S(!0);default:return $()}}return g(),n.getToken()===17?s.allowEmptyContent?!0:(i(4,[],[]),!1):j()?(n.getToken()!==17&&i(9,[],[]),!0):(i(4,[],[]),!1)}var D;(function(e){e[e.None=0]="None",e[e.UnexpectedEndOfComment=1]="UnexpectedEndOfComment",e[e.UnexpectedEndOfString=2]="UnexpectedEndOfString",e[e.UnexpectedEndOfNumber=3]="UnexpectedEndOfNumber",e[e.InvalidUnicode=4]="InvalidUnicode",e[e.InvalidEscapeCharacter=5]="InvalidEscapeCharacter",e[e.InvalidCharacter=6]="InvalidCharacter"})(D||(D={}));var M;(function(e){e[e.OpenBraceToken=1]="OpenBraceToken",e[e.CloseBraceToken=2]="CloseBraceToken",e[e.OpenBracketToken=3]="OpenBracketToken",e[e.CloseBracketToken=4]="CloseBracketToken",e[e.CommaToken=5]="CommaToken",e[e.ColonToken=6]="ColonToken",e[e.NullKeyword=7]="NullKeyword",e[e.TrueKeyword=8]="TrueKeyword",e[e.FalseKeyword=9]="FalseKeyword",e[e.StringLiteral=10]="StringLiteral",e[e.NumericLiteral=11]="NumericLiteral",e[e.LineCommentTrivia=12]="LineCommentTrivia",e[e.BlockCommentTrivia=13]="BlockCommentTrivia",e[e.LineBreakTrivia=14]="LineBreakTrivia",e[e.Trivia=15]="Trivia",e[e.Unknown=16]="Unknown",e[e.EOF=17]="EOF"})(M||(M={}));const J=G;var Q;(function(e){e[e.InvalidSymbol=1]="InvalidSymbol",e[e.InvalidNumberFormat=2]="InvalidNumberFormat",e[e.PropertyNameExpected=3]="PropertyNameExpected",e[e.ValueExpected=4]="ValueExpected",e[e.ColonExpected=5]="ColonExpected",e[e.CommaExpected=6]="CommaExpected",e[e.CloseBraceExpected=7]="CloseBraceExpected",e[e.CloseBracketExpected=8]="CloseBracketExpected",e[e.EndOfFileExpected=9]="EndOfFileExpected",e[e.InvalidCommentToken=10]="InvalidCommentToken",e[e.UnexpectedEndOfComment=11]="UnexpectedEndOfComment",e[e.UnexpectedEndOfString=12]="UnexpectedEndOfString",e[e.UnexpectedEndOfNumber=13]="UnexpectedEndOfNumber",e[e.InvalidUnicode=14]="InvalidUnicode",e[e.InvalidEscapeCharacter=15]="InvalidEscapeCharacter",e[e.InvalidCharacter=16]="InvalidCharacter"})(Q||(Q={}));function Y(e){switch(e){case 1:return"InvalidSymbol";case 2:return"InvalidNumberFormat";case 3:return"PropertyNameExpected";case 4:return"ValueExpected";case 5:return"ColonExpected";case 6:return"CommaExpected";case 7:return"CloseBraceExpected";case 8:return"CloseBracketExpected";case 9:return"EndOfFileExpected";case 10:return"InvalidCommentToken";case 11:return"UnexpectedEndOfComment";case 12:return"UnexpectedEndOfString";case 13:return"UnexpectedEndOfNumber";case 14:return"InvalidUnicode";case 15:return"InvalidEscapeCharacter";case 16:return"InvalidCharacter"}return"<unknown ParseErrorCode>"}self.onmessage=async e=>{const{requestId:u,type:s,payload:n}=e.data;try{switch(s){case"PARSE":{const l=[],k=J(n,l,{allowTrailingComma:!0,disallowComments:!1,allowEmptyContent:!1});if(l.length>0){self.postMessage({requestId:u,type:"ERROR",error:`Parse error: ${Y(l[0].error)}`,errorCount:l.length});break}self.postMessage({requestId:u,type:"SUCCESS",data:k});break}case"STRINGIFY":{const l=JSON.stringify(n.data,null,n.space);self.postMessage({requestId:u,type:"SUCCESS",data:l});break}default:throw new Error(`Unknown message type: ${s}`)}}catch(l){self.postMessage({requestId:u,type:"ERROR",error:l.message,errorCount:1})}}})();
